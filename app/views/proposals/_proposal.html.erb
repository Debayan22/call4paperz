<div class="proposal-item">
  <header>
    <h3><%= link_to proposal.name, event_proposal_path(@event, proposal) %></h3>
    <%= link_to "edit", edit_event_proposal_path(@event, proposal) if user_is_owner?(proposal) %>
  </header>

  <section class="proposal-description">
    <%= markdown(proposal.description) %>
  </section>

  <section class="proposal-metadata">
    <div class="proposal-author">
      <%= user_picture(proposal_user(proposal), width: '24px') %>
      <%= proposal_user(proposal).name %>
    </div>

    <%= link_to "#{proposal.comments.size} comments", [@event, proposal], class: 'proposal-comments' %>
  </section>

  <section class="proposal-voting">
    <div class="voting-controls">
      <% if current_user.has_vote_for?(proposal) %>
        <%= content_tag :button, fa_icon('check') %>
      <% else %>
        <%= image_tag 'ajax-loader.gif', class: 'spinner' %>
        <%= content_tag :button, fa_icon('thumbs-up'), data: {url: like_event_proposal_path(@event, proposal)} %>
        <%= content_tag :button, fa_icon('thumbs-down'), data: {url: dislike_event_proposal_path(@event, proposal)} %>
      <% end %>
    </div>
    <p class="total-votes"><%= proposal.acceptance_points %> votes</p>
  </section>
</div>
